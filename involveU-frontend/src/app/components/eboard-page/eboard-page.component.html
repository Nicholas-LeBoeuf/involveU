<div *ngIf="successMessage === true" class="alert alert-success alert-dismissible fade show eventAlerts" role="alert">
  <p>{{this.message}}</p>
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>

<div *ngIf="failMessage === true" class="alert alert-danger alert-dismissible fade show eventAlerts" role="alert">
  <p>{{this.message}}</p>
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
<h1 class="text-center">{{clubInfo.clubName}} Announcements</h1>
<p-table #clubAnnouncementTable [value]="clubAnnouncements" responsiveLayout="scroll" [scrollable]="true" scrollHeight="500px" [columns]="announcementCols" [globalFilterFields]="['announcementTitle', 'contentOfAnnouncement']">
  <ng-template pTemplate="caption">
    <div class="captionContainer">
      <div class="eventSearchInput">
        <input class="form-control formInputs" style="width: 25%" pInputText type="text" (input)="onFilterAnnouncements($event)" placeholder="Search" />
      </div>
      <div class="addEventButton">
        <button (click) = "showCreateAnnouncementDialog()" class="yellowButton">Create Announcement</button>
      </div>
    </div>
  </ng-template>
  <ng-template pTemplate="header" let-columns>
    <tr>
      <th style="text-align: center" *ngFor="let col of columns" [pSortableColumn]="col.field">{{col.header}} <p-sortIcon [field]="col.field"></p-sortIcon></th>
      <th style="text-align: center">Edit</th>
      <th style="text-align: center">Delete</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-announcement>
    <tr>
      <td style="text-align: center">{{announcement.announcementTitle}}</td>
      <td style="text-align: center">{{announcement.contentOfAnnouncement}}</td>
      <td style="text-align: center">{{announcement.postedOn | date:'MMMM dd, YYYY'}}</td>
      <td style="text-align: center">{{announcement.expiresOn | date:'MMMM dd, YYYY'}}</td>
      <td><button (click) = "showEditAnnouncementDialog(announcement)" class="yellowButton">Edit</button></td>
      <td><button (click)= "deleteAnnouncement(announcement.announcementID)" class="yellowButton">Delete</button></td>
    </tr>
  </ng-template>
</p-table>

<p-dialog [(visible)]="createAnnouncementDialog" [modal]="true" [style]="{width: '35vw'}" [dismissableMask]="true" [baseZIndex]="10000" (onHide)="closeCreateAnnouncementDialog()">
  <a class="ui-dialog-titlebar-icon ui-dialog-titlebar-close ui-corner-all closeButtonDialog" role="button" (click)="closeCreateAnnouncementDialog()">
    <span class="fa fa-fw fa-close fa-lg"></span>
  </a>
  <h1>{{clubInfo.clubName}}</h1>
  <div class="osiAnnouncementsDiv">
    <h1 class="dialogTitle">Create Announcement</h1>
    <form [formGroup]="announcementForm">
      <div class="osiAnnouncements">
        <div class="form-group">
          <input class="form-control formInputs" type="text" placeholder="Title" formControlName="announcementTitle">
          <div *ngIf="announcementFormInputs?.['announcementTitle']?.invalid && (announcementFormInputs?.['announcementTitle']?.dirty || announcementFormInputs?.['announcementTitle']?.touched)" class="requiredAlert alert-danger">
            <div *ngIf="announcementFormInputs?.['announcementTitle']?.errors?.['required']">
              Announcement Title is required
            </div>
          </div>
        </div>
        <div class="form-group">
          <input class="form-control formInputs" type="date" placeholder="Expiration Date: &nbsp;" formControlName="expiresOn">
          <div *ngIf="announcementFormInputs?.['expiresOn']?.invalid && (announcementFormInputs?.['expiresOn']?.dirty || announcementFormInputs?.['expiresOn']?.touched)" class="leftAlert alert-danger">
            <div *ngIf="announcementFormInputs?.['expiresOn']?.errors?.['required']">
              Expiration Date is required
            </div>
          </div>
        </div>
        <div class="form-group">
          <textarea class="form-control formInputs largeTextField"placeholder="Announcement Content" formControlName="contentOfAnnouncement"></textarea>
          <div *ngIf="announcementFormInputs?.['contentOfAnnouncement']?.invalid && (announcementFormInputs?.['contentOfAnnouncement']?.dirty || announcementFormInputs?.['contentOfAnnouncement']?.touched)" class="requiredAlert alert-danger">
            <div *ngIf="announcementFormInputs?.['contentOfAnnouncement']?.errors?.['required']">
              Announcement content is required
            </div>
          </div>
        </div>
        <div class="centerButton">
          <button class="form-submit-button yellowButton" type="submit" (click)="createAnnouncementSubmit()">Create Announcement</button>
        </div>
      </div>
    </form>
  </div>
</p-dialog>

<p-dialog [(visible)]="editAnnouncementDialog" [modal]="true" [style]="{width: '35vw'}" [dismissableMask]="true" [baseZIndex]="10000" (onHide)="closeEditAnnouncementDialog()">
  <a class="ui-dialog-titlebar-icon ui-dialog-titlebar-close ui-corner-all closeButtonDialog" role="button" (click)="closeEditAnnouncementDialog()">
    <span class="fa fa-fw fa-close fa-lg"></span>
  </a>
  <div *ngIf="addEventSuccess === true" class="alert alert-success alert-dismissible fade show clubCreationAlerts" role="alert">
    <p>Announcement created successfully!</p>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
  <div *ngIf="addEventFailed === true" class="alert alert-danger alert-dismissible fade show clubCreationAlerts" role="alert">
    <p>Error creating announcement.</p>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
  <h1>{{clubInfo.clubName}}</h1>
  <div class="osiAnnouncementsDiv">
    <div *ngFor="let announcement of this.certainAnnouncement" >
      <h1 class="dialogTitle">Edit Announcement</h1>
      <form [formGroup]="editAnnouncementForm">
        <div class="osiAnnouncements">
          <div class="form-group">
            <input class="form-control formInputs" type="text" [(ngModel)] = "announcement.announcementTitle" formControlName="editAnnouncementTitle">
            <div *ngIf="announcementFormInputs?.['announcementTitle']?.invalid && (announcementFormInputs?.['announcementTitle']?.dirty || announcementFormInputs?.['announcementTitle']?.touched)" class="requiredAlert alert-danger">
              <div *ngIf="announcementFormInputs?.['announcementTitle']?.errors?.['required']">
                Announcement Title is required
              </div>
            </div>
          </div>
          <div class="form-group">
            <input class="form-control formInputs" type="date" [(ngModel)] = "announcement.expiresOn" formControlName="editExpiresOn">
            <div *ngIf="announcementFormInputs?.['expiresOn']?.invalid && (announcementFormInputs?.['expiresOn']?.dirty || announcementFormInputs?.['expiresOn']?.touched)" class="leftAlert alert-danger">
              <div *ngIf="announcementFormInputs?.['expiresOn']?.errors?.['required']">
                Expiration Date is required
              </div>
            </div>
          </div>
          <div class="form-group">
            <textarea class="form-control formInputs largeTextField" [(ngModel)] = "announcement.contentOfAnnouncement" formControlName="editContentOfAnnouncement"></textarea>
            <div *ngIf="announcementFormInputs?.['contentOfAnnouncement']?.invalid && (announcementFormInputs?.['contentOfAnnouncement']?.dirty || announcementFormInputs?.['contentOfAnnouncement']?.touched)" class="requiredAlert alert-danger">
              <div *ngIf="announcementFormInputs?.['contentOfAnnouncement']?.errors?.['required']">
                Announcement content is required
              </div>
            </div>
          </div>
          <div class="centerButton">
            <button class="form-submit-button yellowButton" type="submit" (click)="updateClubAnnouncementSubmit()">Edit Announcement</button>
          </div>
        </div>
      </form>
    </div>
  </div>
</p-dialog>

<h1 class="text-center">{{clubInfo.clubName}} Events</h1>
<p-table #clubEventTable [value]="clubEvents" responsiveLayout="scroll" [scrollable]="true" scrollHeight="500px" [columns]="cols" [globalFilterFields]="['eventName', 'eventLocation']">
  <ng-template pTemplate="caption">
    <div class="captionContainer">
      <div class="eventSearchInput">
        <input class="form-control formInputs" style="width: 25%" pInputText type="text" (input)="onFilterEventName($event)" placeholder="Search" />
      </div>
      <div class="addEventButton">
        <button (click) = "showAddEventDialog()" class="yellowButton"> Add Event</button>
      </div>
    </div>
  </ng-template>
  <ng-template pTemplate="header" let-columns>
    <tr>
      <th style="text-align: center" *ngFor="let col of columns" [pSortableColumn]="col.field">{{col.header}} <p-sortIcon [field]="col.field"></p-sortIcon></th>
      <th style="text-align: center">Edit</th>
      <th style="text-align: center">Delete</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-event>
    <tr>
      <td style="text-align: center">{{event.eventName}}</td>
      <td style="text-align: center">{{event.eventDate | date:'MMMM dd, YYYY'}}</td>
      <td style="text-align: center">{{event.startTime | timeFormat}}</td>
      <td style="text-align: center">{{event.endTime  | timeFormat}}</td>
      <td style="text-align: center">{{event.eventLocation}}</td>
      <td style="text-align: center">{{event.eventDesc}}</td>
      <td style="text-align: center">{{event.ticketLink}}</td>
      <td style="text-align: center">{{event.isTransportation}}</td>
      <td><button (click) = "showEditDialog(event)" class="yellowButton">Edit</button></td>
      <td><button (click)= "deleteEvent(event.eventID)" class="yellowButton">Delete</button></td>
    </tr>
  </ng-template>
</p-table>



<p-dialog [(visible)]="addEventDialog" [modal]="true" [style]="{width: '35vw'}" [dismissableMask]="true" [baseZIndex]="10000" (onHide)="closeAddEventDialog()">
  <a class="ui-dialog-titlebar-icon ui-dialog-titlebar-close ui-corner-all closeButtonDialog" role="button" (click)="closeAddEventDialog()">
    <span class="fa fa-fw fa-close fa-lg"></span>
  </a>
  <div *ngIf="addEventSuccess === true" class="alert alert-success alert-dismissible fade show clubCreationAlerts" role="alert">
    <p>Event added successfully!</p>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
  <div *ngIf="addEventFailed === true" class="alert alert-danger alert-dismissible fade show clubCreationAlerts" role="alert">
    <p>Error adding event.</p>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
  <h1 class="text-center">Add Events</h1>
  <hr class="dialogLines">
  <form [formGroup]="createEventForm">
    <div class="addEditEventDialogContainer">
      <div class="eventTitle containerContentSize">
        <label class="dialogLabels">Event Name</label>
        <input class="form-control formInputs" type="text" placeholder="Event Name" formControlName="createEventName">
        <div *ngIf="getCreateEventsFormInputs?.['eventName']?.invalid && (getCreateEventsFormInputs?.['eventName']?.dirty || getCreateEventsFormInputs?.['eventName']?.touched)" class="leftAlert alert-danger">
          <div *ngIf="getCreateEventsFormInputs?.['eventName']?.errors?.['required']">
            Event Name is required
          </div>
        </div>
      </div>
      <div class="eventDate containerContentSize">
        <label class="dialogLabels">Event Date</label>
        <input class="form-control formInputs" type="date" placeholder="Event Date" formControlName="createEventDate">
        <div *ngIf="getCreateEventsFormInputs?.['eventDate']?.invalid && (getCreateEventsFormInputs?.['eventDate']?.dirty || getCreateEventsFormInputs?.['eventDate']?.touched)" class="leftAlert alert-danger">
          <div *ngIf="getCreateEventsFormInputs?.['eventDate']?.errors?.['required']">
            Event Date is required
          </div>
        </div>
      </div>
      <div class="eventStart containerContentSize">
        <label class="dialogLabels">Start Time</label>
        <input class="form-control formInputs" type="time" placeholder="Start Time" formControlName="createStartTime">
        <div *ngIf="getCreateEventsFormInputs?.['startTime']?.invalid && (getCreateEventsFormInputs?.['startTime']?.dirty || getCreateEventsFormInputs?.['startTime']?.touched)" class="leftAlert alert-danger">
          <div *ngIf="getCreateEventsFormInputs?.['startTime']?.errors?.['required']">
            Start time is required
          </div>
        </div>
      </div>
      <div class="eventEnd containerContentSize">
        <label class="dialogLabels">End Time</label>
        <input class="form-control formInputs" type="time" placeholder="End Time" formControlName="createEndTime">
        <div *ngIf="getCreateEventsFormInputs?.['endTime']?.invalid && (getCreateEventsFormInputs?.['endTime']?.dirty || getCreateEventsFormInputs?.['endTime']?.touched)" class="leftAlert alert-danger">
          <div *ngIf="getCreateEventsFormInputs?.['endTime']?.errors?.['required']">
            End time is required
          </div>
        </div>
      </div>
      <div class="eventLocation containerContentSize">
        <label class="dialogLabels">Location</label>
        <p-dropdown [options]="locations" [formControl]="locationID" [filter]="true" [autoDisplayFirst]="false" optionValue="location_ID" optionLabel="locationName" placeholder="Select Location" class="dropdownLength" (onChange)="checkLocationSelected()" [style]="{'width':'400px', 'height':'50px', 'border':'2px solid #0667B3', 'border-radius':'10px'}"></p-dropdown>
        <div *ngIf="getCreateEventsFormInputs?.['locationName']?.invalid && (getCreateEventsFormInputs?.['locationName']?.dirty || getCreateEventsFormInputs?.['locationName']?.touched)" class="leftAlert alert-danger">
          <div *ngIf="getCreateEventsFormInputs?.['locationName']?.errors?.['required']">
            Location is required
          </div>
        </div>
      </div>
      <div class="eventSpace containerContentSize">
        <label class="dialogLabels">Space</label>
        <p-dropdown [options]="spaces" [formControl]="spaceID" [filter]="true" [autoDisplayFirst]="false" [disabled]="disableUserDropdown" optionValue="space_ID" optionLabel="spaceName" placeholder="Select Space" class="dropdownLength" [style]="{'width':'400px', 'height':'50px', 'border':'2px solid #0667B3', 'border-radius':'10px'}"></p-dropdown>
        <div *ngIf="getCreateEventsFormInputs?.['spaceName']?.invalid && (getCreateEventsFormInputs?.['spaceName']?.dirty || getCreateEventsFormInputs?.['spaceName']?.touched)" class="leftAlert alert-danger">
          <div *ngIf="getCreateEventsFormInputs?.['spaceName']?.errors?.['required']">
            Space is required
          </div>
        </div>
      </div>
      <div class="eventDesc containerDescContentSize">
        <label class="dialogLabels">Description</label>
        <textarea class="form-control formInputs" type="text" placeholder="Event Description" formControlName="createEventDesc"></textarea>
        <div *ngIf="getCreateEventsFormInputs?.['eventDesc']?.invalid && (getCreateEventsFormInputs?.['eventDesc']?.dirty || getCreateEventsFormInputs?.['eventDesc']?.touched)" class="leftAlert alert-danger">
          <div *ngIf="getCreateEventsFormInputs?.['eventDesc']?.errors?.['required']">
            Event Description is required
          </div>
        </div>
      </div>
      <div class="eventLink containerContentSize">
        <label class="dialogLabels">Ticket Link (Optional)</label>
        <input class="form-control formInputs" type="text" formControlName="createTicketLink">
      </div>
      <div class="eventTransp containerContentSize transpMargin">
        <label style="padding: 8px" class="dialogLabels">Transportation?</label>
        <input style="transform: scale(1.5)"type="checkbox" formControlName="createIsTransportation">
      </div>
      <div class="eventButton buttonSize">
        <button class="yellowButton" type="submit" [disabled]="areCreateFormInputsValid()" (click)="submitNewEvent()">Create Event</button>
      </div>
    </div>
  </form>
</p-dialog>

<p-dialog  [(visible)]="editDialog" [modal]="true" [style]="{width: '35vw'}" [dismissableMask]="true" [baseZIndex]="10000" (onHide)="closeEditDialog()">
  <a class="ui-dialog-titlebar-icon ui-dialog-titlebar-close ui-corner-all closeButtonDialog" role="button" (click)="closeEditDialog()">
    <span class="fa fa-fw fa-close fa-lg"></span>
  </a>
  <div *ngIf="editEventSuccess === true" class="alert alert-success alert-dismissible fade show clubCreationAlerts" role="alert">
    <p>Event edited successfully!</p>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
  <div *ngIf="editEventFailed === true" class="alert alert-danger alert-dismissible fade show clubCreationAlerts" role="alert">
    <p>Error editing event.</p>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
  <div *ngFor="let event of this.certainEvent" >
    <h1 class="text-center">Edit Event</h1>
    <hr class="dialogLines">
    <form [formGroup]="editEventForm">
      <div class="addEditEventDialogContainer">
        <div class="eventTitle containerContentSize">
          <label class="dialogLabels">Event Name</label>
          <input class="form-control formInputs" type="text" [(ngModel)] = "event.eventName" formControlName="editEventName">
          <div *ngIf="getEditEventsFormInputs?.['eventName']?.invalid && (getEditEventsFormInputs?.['eventName']?.dirty || getEditEventsFormInputs?.['eventName']?.touched)" class="leftAlert alert-danger">
            <div *ngIf="getEditEventsFormInputs?.['eventName']?.errors?.['required']">
              Event Name is required
            </div>
          </div>
        </div>
        <div class="eventDate containerContentSize">
          <label class="dialogLabels">Event Date</label>
          <input class="form-control formInputs" type="date" [(ngModel)] = "event.eventDate" formControlName="editEventDate">
          <div *ngIf="getEditEventsFormInputs?.['eventDate']?.invalid && (getEditEventsFormInputs?.['eventDate']?.dirty || getEditEventsFormInputs?.['eventDate']?.touched)" class="leftAlert alert-danger">
            <div *ngIf="getEditEventsFormInputs?.['eventDate']?.errors?.['required']">
              Event Date is required
            </div>
          </div>
        </div>
        <div class="eventStart containerContentSize">
          <label class="dialogLabels">Start Time</label>
          <input class="form-control formInputs" type="time" [(ngModel)]="event.startTime" formControlName="editStartTime">
          <div *ngIf="getEditEventsFormInputs?.['startTime']?.invalid && (getEditEventsFormInputs?.['startTime']?.dirty || getEditEventsFormInputs?.['startTime']?.touched)" class="leftAlert alert-danger">
            <div *ngIf="getEditEventsFormInputs?.['startTime']?.errors?.['required']">
              Start time is required
            </div>
          </div>
        </div>
        <div class="eventEnd containerContentSize">
          <label class="dialogLabels">End Time</label>
          <input class="form-control formInputs" type="time" [(ngModel)] = "event.endTime" formControlName="editEndTime">
          <div *ngIf="getEditEventsFormInputs?.['endTime']?.invalid && (getEditEventsFormInputs?.['endTime']?.dirty || getEditEventsFormInputs?.['endTime']?.touched)" class="leftAlert alert-danger">
            <div *ngIf="getEditEventsFormInputs?.['endTime']?.errors?.['required']">
              End time is required
            </div>
          </div>
        </div>
        <div class="eventLocation containerContentSize">
          <label class="dialogLabels">Location</label>
          <input class="form-control formInputs" type="text" [(ngModel)]  ="event.eventLocation" formControlName="editEventLocation">
          <div *ngIf="getEditEventsFormInputs?.['eventLocation']?.invalid && (getEditEventsFormInputs?.['eventLocation']?.dirty || getEditEventsFormInputs?.['eventLocation']?.touched)" class="leftAlert alert-danger">
            <div *ngIf="getEditEventsFormInputs?.['eventLocation']?.errors?.['required']">
              Location is required
            </div>
          </div>
        </div>
        <div class="eventDesc containerDescContentSize">
          <label class="dialogLabels">Description</label>
          <textarea class="form-control formInputs" [(ngModel)] = "event.eventDesc" formControlName="editEventDesc"></textarea>
          <div *ngIf="getEditEventsFormInputs?.['eventDesc']?.invalid && (getEditEventsFormInputs?.['eventDesc']?.dirty || getEditEventsFormInputs?.['eventDesc']?.touched)" class="leftAlert alert-danger">
            <div *ngIf="getEditEventsFormInputs?.['eventDesc']?.errors?.['required']">
              Event Description is required
            </div>
          </div>
        </div>
        <div class="eventLink containerContentSize">
          <label class="dialogLabels">Ticket Link (Optional)</label>
          <input class="form-control formInputs" type="text" [(ngModel)]  ="event.ticketLink" formControlName="editTicketLink">
        </div>
        <div class="eventTransp containerContentSize transpMargin">
          <label style="padding: 8px" class="dialogLabels">Transportation?</label>
          <input style="transform: scale(1.5)"type="checkbox" [(ngModel)] = "event.isTransportation" formControlName="editIsTransportation">
        </div>
        <div class="eventButton buttonSize">
          <button class="yellowButton" type="submit" [disabled] = "areEditFormInputsValid()" (click)="updateEvent()">Edit</button>
        </div>
      </div>
    </form>
  </div>
</p-dialog>
