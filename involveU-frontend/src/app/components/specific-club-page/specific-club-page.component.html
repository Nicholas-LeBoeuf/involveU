<div *ngIf="successMessage === true" class="alert alert-success alert-dismissible fade show eventAlerts" role="alert">
  <p>{{this.message}}</p>
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>

<div *ngIf="failMessage === true" class="alert alert-danger alert-dismissible fade show eventAlerts" role="alert">
  <p>{{this.message}}</p>
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>

<div class="clubContainer">
  <div class="clubNameSection clubGridStyle">
    <div class="sectionContent">
      <h1 class="clubsName">Welcome to {{clubInfo.clubName}}!</h1>
      <div class="buttonRow">
        <ng-container *ngIf=" this.cookie.get('userID') != undefined && this.isInEboard() === true;">
          <button class="clubButton blueButton" (click)="showEventsDialog()">Event Data</button>
        </ng-container>
        <ng-container *ngIf=" this.cookie.get('userID') != undefined && this.clubIsFav;">
          <button class="clubButton blueButton" (click)="removeFromFavorites(this.userID, this.clubID)">Unfavorite</button>
        </ng-container>
        <ng-template *ngIf=" this.cookie.get('userID') != undefined && !this.clubIsFav;">
          <button class="clubButton blueButton" (click)="favoriteClub(this.userID, this.clubID)">Favorite</button>
        </ng-template>
      </div>
    </div>
  </div>
  <div class="clubLogoSection clubGridStyle">
    <div class="sectionContent">
      <img class="clubsLogo" src="assets/{{clubInfo.clubLogo}}">
      <h2 class="text-center">Affiliated With</h2>
      <h2 class="text-center">{{clubInfo.clubAffiliation}}</h2>
    </div>
  </div>
</div>
<div class="bioAndEboard">
  <div class="bioSection">
    <h1 class="text-center addTopMargin">Who Are We?</h1>
    <div class="sectionContent bioandEboardContent">
      <h5 class="text-center">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</h5>
    </div>
  </div>
  <div class="eboardSection">
    <h1 class="text-center addTopMargin">The EBoard!</h1>
    <div class="sectionContent bioandEboardContent">

      <table>
        <div class = "eboardContainer" *ngFor="let member of clubEboard"  >
           <tr class = "eboardTableData">
             <td><h5>{{member.eboardPosition}} -> </h5></td>
             <td><h5> {{member.firstName}} {{member.lastName}}</h5></td>
           </tr>
        </div>
      </table>


    </div>
  </div>
</div>
<div class="missionValueVision">
  <div class="mission">
    <h1 class="text-center addTopMargin">Mission</h1>
    <div class="sectionContent bioandEboardContent">
      <h5 class="text-center">{{clubInfo.clubMission}}</h5>
    </div>
  </div>
  <div class="values">
    <h1 class="text-center addTopMargin">Values</h1>
    <div class="sectionContent bioandEboardContent">
      <h5 class="text-center">{{clubInfo.clubValues}}</h5>
    </div>
  </div>
  <div class="vision">
    <h1 class="text-center addTopMargin">Vision</h1>
    <div class="sectionContent bioandEboardContent">
      <h5 class="text-center">{{clubInfo.clubVision}}</h5>
    </div>
  </div>
</div>

<div class="clubEventsBackground">
  <h1 class="text-center">Club Events</h1>
  <p-carousel styleClass="eventsCaro" [value]="clubEvents" [numVisible]="3" [numScroll]="3" [circular]="true" [autoplayInterval]="10000">
    <ng-template let-event pTemplate="item">
      <div class="clubCard">
        <div class="clubContent">
          <div>
            <h3 class="p-mb-1">{{event.eventName}}</h3>
            <hr>
            <div class="parent">
              <div class="div1">
                <h3 class="eventDataTitle">Date</h3>
                <h5 class="eventData">{{event.eventDate | date:'MMMM dd, YYYY'}}</h5>
              </div>
              <div class="div2">
                <h3 class="eventDataTitle">Time</h3>
                <h5 class="eventData">{{event.startTime | timeFormat}} - {{event.endTime | timeFormat}}</h5>
              </div>
              <div class="div3">
                <h3 class="eventDataTitle">Location</h3>
                <h5 class="eventData">{{event.eventLocation}}</h5>
              </div>
              <div class="div4">
                <h3 class="eventDataTitle">Hosted By</h3>
                <h5 class="eventData">{{event.clubID}}</h5>
              </div>
              <div class="div5">
                <button class="blueButton" (click)="showViewMoreInfoDialog(event)">View More Information</button>
                <ng-container *ngIf="isUserRSVPd(event.eventID) === true; else ShowRSVP">
                  <button class="blueButton" (click)="removeEventRSVP(event.eventID)">Remove RSVP</button>
                </ng-container>
                <ng-template #ShowRSVP>
                  <button class="blueButton" (click)="eventRSVP(event.eventID)">RSVP</button>
                </ng-template>
              </div>
            </div>
          </div>
        </div>
      </div>
    </ng-template>
  </p-carousel>
</div>

<p-dialog [(visible)]="eventDialog" [modal]="true" [style]="{width: '35vw'}" [dismissableMask]="true" [baseZIndex]="10000" (onHide)="closeEventsDialog()">
  <a class="ui-dialog-titlebar-icon ui-dialog-titlebar-close ui-corner-all closeButtonDialog" role="button" (click)="closeEventsDialog()">
    <span class="fa fa-fw fa-close fa-lg"></span>
  </a>
  <H1>EVENTS</H1>
  <p-table [value]="clubEvents">
    <ng-template pTemplate="header">
      <tr>
        <th>Name</th>
        <th>Location</th>
        <th>Date</th>
        <th>Start Time</th>
        <th>End Time</th>
        <th></th>
        <th></th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-event>
      <tr>

        <td>{{event.eventName}}</td>
        <td>{{event.eventLocation}}</td>
        <td>{{event.eventDate | date:'MMMM dd, YYYY'}}</td>
        <td>{{event.startTime | timeFormat}}</td>
        <td>{{event.endTime  | timeFormat}}</td>
        <td><button (click) = "showEditDialog(event)" class="blueButton">Edit</button></td>
        <td><button (click)= "deleteEvent(event.eventID)" class="blueButton">Delete</button></td>
      </tr>
    </ng-template>
  </p-table>

  <button (click) = "showAddEventDialog()" class="blueButton"> Add Event</button>

</p-dialog>

<p-dialog [(visible)]="addEventDialog" [modal]="true" [style]="{width: '35vw'}" [dismissableMask]="true" [baseZIndex]="10000" (onHide)="closeAddEventDialog()">
  <a class="ui-dialog-titlebar-icon ui-dialog-titlebar-close ui-corner-all closeButtonDialog" role="button" (click)="closeAddEventDialog()">
    <span class="fa fa-fw fa-close fa-lg"></span>
  </a>
  <h1 class="text-center">Add Events</h1>
  <hr class="dialogLines">
  <form [formGroup]="createEventForm">
    <div class="addEditEventDialogContainer">
      <div class="eventTitle containerContentSize">
        <label class="dialogLabels">Event Name</label>
        <input class="form-control formInputs" type="text" placeholder="Event Name" formControlName="eventName">
        <div *ngIf="getEventsFormInputs?.['eventName']?.invalid && (getEventsFormInputs?.['eventName']?.dirty || getEventsFormInputs?.['eventName']?.touched)" class="leftAlert alert-danger">
          <div *ngIf="getEventsFormInputs?.['eventName']?.errors?.['required']">
            Event Name is required
          </div>
        </div>
      </div>
      <div class="eventDate containerContentSize">
        <label class="dialogLabels">Event Date</label>
        <input class="form-control formInputs" type="date" placeholder="Event Date" formControlName="eventDate">
        <div *ngIf="getEventsFormInputs?.['eventDate']?.invalid && (getEventsFormInputs?.['eventDate']?.dirty || getEventsFormInputs?.['eventDate']?.touched)" class="leftAlert alert-danger">
          <div *ngIf="getEventsFormInputs?.['eventDate']?.errors?.['required']">
            Event Date is required
          </div>
        </div>
      </div>
      <div class="eventStart containerContentSize">
        <label class="dialogLabels">Start Time</label>
        <input class="form-control formInputs" type="time" placeholder="Start Time" formControlName="startTime">
        <div *ngIf="getEventsFormInputs?.['startTime']?.invalid && (getEventsFormInputs?.['startTime']?.dirty || getEventsFormInputs?.['startTime']?.touched)" class="leftAlert alert-danger">
          <div *ngIf="getEventsFormInputs?.['startTime']?.errors?.['required']">
            Start time is required
          </div>
        </div>
      </div>
      <div class="eventEnd containerContentSize">
        <label class="dialogLabels">End Time</label>
        <input class="form-control formInputs" type="time" placeholder="End Time" formControlName="endTime">
        <div *ngIf="getEventsFormInputs?.['endTime']?.invalid && (getEventsFormInputs?.['endTime']?.dirty || getEventsFormInputs?.['endTime']?.touched)" class="leftAlert alert-danger">
          <div *ngIf="getEventsFormInputs?.['endTime']?.errors?.['required']">
            End time is required
          </div>
        </div>
      </div>
      <div class="eventLocation containerContentSize">
        <label class="dialogLabels">Location</label>
        <input class="form-control formInputs" type="text" placeholder="Location" formControlName="eventLocation">
        <div *ngIf="getEventsFormInputs?.['eventLocation']?.invalid && (getEventsFormInputs?.['eventLocation']?.dirty || getEventsFormInputs?.['eventLocation']?.touched)" class="leftAlert alert-danger">
          <div *ngIf="getEventsFormInputs?.['eventLocation']?.errors?.['required']">
            Location is required
          </div>
        </div>
      </div>
      <div class="eventDesc containerDescContentSize">
        <label class="dialogLabels">Description</label>
        <textarea class="form-control formInputs" type="text" placeholder="Event Description" formControlName="eventDesc"></textarea>
        <div *ngIf="getEventsFormInputs?.['eventDesc']?.invalid && (getEventsFormInputs?.['eventDesc']?.dirty || getEventsFormInputs?.['eventDesc']?.touched)" class="leftAlert alert-danger">
          <div *ngIf="getEventsFormInputs?.['eventDesc']?.errors?.['required']">
            Event Description is required
          </div>
        </div>
      </div>
      <div class="eventLink containerContentSize">
        <label class="dialogLabels">Ticket Link (Optional)</label>
        <input class="form-control formInputs" type="text" formControlName="ticketLink">
      </div>
      <div class="eventTransp containerContentSize transpMargin">
        <label style="padding: 8px" class="dialogLabels">Transportation?</label>
        <input style="transform: scale(1.5)"type="checkbox" formControlName="isTransportation">
      </div>
      <div class="eventButton buttonSize">
        <button class="blueButton" type="submit"  [disabled] = "areFormInputsValid()" (click)="submitNewEvent()">Create Event</button>
      </div>
    </div>
  </form>
</p-dialog>

<p-dialog  [(visible)]="editDialog" [modal]="true" [style]="{width: '35vw'}" [dismissableMask]="true" [baseZIndex]="10000" (onHide)="closeEditDialog()">
  <a class="ui-dialog-titlebar-icon ui-dialog-titlebar-close ui-corner-all closeButtonDialog" role="button" (click)="closeEditDialog()">
    <span class="fa fa-fw fa-close fa-lg"></span>
  </a>
  <div *ngIf="editEventSuccess === true" class="alert alert-success alert-dismissible fade show clubCreationAlerts" role="alert">
    <p>Event edited successfully!</p>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
  <div *ngIf="editEventFailed === true" class="alert alert-danger alert-dismissible fade show clubCreationAlerts" role="alert">
    <p>Error editing event.</p>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
    <div *ngFor="let event of this.certainEvent" >
      <h1 class="text-center">Edit Event</h1>
      <hr class="dialogLines">
      <form [formGroup]="createEventForm">
        <div class="addEditEventDialogContainer">
          <div class="eventTitle containerContentSize">
            <label class="dialogLabels">Event Name</label>
            <input class="form-control formInputs" type="text" [(ngModel)] = "event.eventName" formControlName="eventName">
            <div *ngIf="getEventsFormInputs?.['eventName']?.invalid && (getEventsFormInputs?.['eventName']?.dirty || getEventsFormInputs?.['eventName']?.touched)" class="leftAlert alert-danger">
              <div *ngIf="getEventsFormInputs?.['eventName']?.errors?.['required']">
                Event Name is required
              </div>
            </div>
          </div>
          <div class="eventDate containerContentSize">
            <label class="dialogLabels">Event Date</label>
            <input class="form-control formInputs" type="date" [(ngModel)] = "event.eventDate" formControlName="eventDate">
            <div *ngIf="getEventsFormInputs?.['eventDate']?.invalid && (getEventsFormInputs?.['eventDate']?.dirty || getEventsFormInputs?.['eventDate']?.touched)" class="leftAlert alert-danger">
              <div *ngIf="getEventsFormInputs?.['eventDate']?.errors?.['required']">
                Event Date is required
              </div>
            </div>
          </div>
          <div class="eventStart containerContentSize">
            <label class="dialogLabels">Start Time</label>
            <input class="form-control formInputs" type="time" [(ngModel)]="event.startTime" formControlName="startTime">
            <div *ngIf="getEventsFormInputs?.['startTime']?.invalid && (getEventsFormInputs?.['startTime']?.dirty || getEventsFormInputs?.['startTime']?.touched)" class="leftAlert alert-danger">
              <div *ngIf="getEventsFormInputs?.['startTime']?.errors?.['required']">
                Start time is required
              </div>
            </div>
          </div>
          <div class="eventEnd containerContentSize">
            <label class="dialogLabels">End Time</label>
            <input class="form-control formInputs" type="time" [(ngModel)] = "event.endTime" formControlName="endTime">
            <div *ngIf="getEventsFormInputs?.['endTime']?.invalid && (getEventsFormInputs?.['endTime']?.dirty || getEventsFormInputs?.['endTime']?.touched)" class="leftAlert alert-danger">
              <div *ngIf="getEventsFormInputs?.['endTime']?.errors?.['required']">
                End time is required
              </div>
            </div>
          </div>
          <div class="eventLocation containerContentSize">
            <label class="dialogLabels">Location</label>
            <input class="form-control formInputs" type="text" [(ngModel)]  ="event.eventLocation" formControlName="eventLocation">
            <div *ngIf="getEventsFormInputs?.['eventLocation']?.invalid && (getEventsFormInputs?.['eventLocation']?.dirty || getEventsFormInputs?.['eventLocation']?.touched)" class="leftAlert alert-danger">
              <div *ngIf="getEventsFormInputs?.['eventLocation']?.errors?.['required']">
                Location is required
              </div>
            </div>
          </div>
          <div class="eventDesc containerDescContentSize">
            <label class="dialogLabels">Description</label>
            <textarea class="form-control formInputs" [(ngModel)] = "event.eventDesc" formControlName="eventDesc"></textarea>
            <div *ngIf="getEventsFormInputs?.['eventDesc']?.invalid && (getEventsFormInputs?.['eventDesc']?.dirty || getEventsFormInputs?.['eventDesc']?.touched)" class="leftAlert alert-danger">
              <div *ngIf="getEventsFormInputs?.['eventDesc']?.errors?.['required']">
                Event Description is required
              </div>
            </div>
          </div>
          <div class="eventLink containerContentSize">
            <label class="dialogLabels">Ticket Link (Optional)</label>
            <input class="form-control formInputs" type="text" [(ngModel)]  ="event.ticketLink" formControlName="ticketLink">
          </div>
          <div class="eventTransp containerContentSize transpMargin">
            <label style="padding: 8px" class="dialogLabels">Transportation?</label>
            <input style="transform: scale(1.5)"type="checkbox" [(ngModel)] = "event.isTransportation" formControlName="isTransportation">
          </div>
          <div class="eventButton buttonSize">
            <button class="blueButton" type="submit"  [disabled] = "areFormInputsValid()" (click)="updateEvent()">Edit</button>
          </div>
        </div>
      </form>

    </div>

</p-dialog>

<p-dialog [(visible)]="viewMoreInfoDialog" [modal]="true" [style]="{width: '35vw'}" [dismissableMask]="true" [baseZIndex]="10000" (onHide)="closeViewMoreInfoDialog()">
  <a class="ui-dialog-titlebar-icon ui-dialog-titlebar-close ui-corner-all closeButtonDialog" role="button" (click)="closeViewMoreInfoDialog()">
    <span class="fa fa-fw fa-close fa-lg"></span>
  </a>
  <h1 class="text-center">Event Information</h1>
  <hr class="dialogLines">
  <div *ngFor="let event of this.certainEvent" >
    <div class="eventInfoContainer">
      <div class="eventName">
        <h3 class="eventDataTitle">Event Name: </h3>
        <h5 class="eventData">{{event.eventName}}</h5>
      </div>
      <div class="eventDate">
        <h3 class="eventDataTitle">Event Date: </h3>
        <h5 class="eventData">{{event.eventDate | date:'MMMM dd, YYYY'}}</h5>
      </div>
      <div class="eventTime">
        <h3 class="eventDataTitle">Time: </h3>
        <h5 class="eventData">{{event.startTime | timeFormat}} - {{event.endTime | timeFormat}}</h5>
      </div>
      <div class="eventLocation">
        <h3 class="eventDataTitle">Event Location: </h3>
        <h5 class="eventData">{{event.eventLocation}}</h5>
      </div>
      <div class="eventDesc">
        <h3 class="eventDataTitle">Event Description: </h3>
        <h5 class="eventData">{{event.eventDesc}}</h5>
      </div>
      <div class="eventHost">
        <h3 class="eventDataTitle">Hosted By:</h3>
        <h5 class="eventData">{{event.clubName}}</h5>
      </div>
      <div class="eventTransportation">
        <h3 class="eventDataTitle">Transportation</h3>
        <ng-container *ngIf="event.isTransportation; else noTransportation">
          <h5 class="eventData">Transportation Provided</h5>
        </ng-container>
        <ng-template #noTransportation>
          <h5 class="eventData">Transportation NOT provided</h5>
        </ng-template>
      </div>
      <div class="eventTicketLink">
        <h3 class="eventDataTitle">Ticket Link:</h3>
        <h5 class="eventData">{{event.ticketLink}}</h5>
      </div>
    </div>
  </div>
</p-dialog>
